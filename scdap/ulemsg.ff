*mlist
*if def,selap
       subroutine ulemsg (info, name, ni, i1, i2, nr, r1, r2)
c
c  ulemsg writes error condition / message code information to the 6-th
c  logical unit.
c
c  Cognizant engineer: ewc.
c
c  ...1...  arguments / parameters / constants  .......
c  ...2...  notes / remarks  .......
c
       implicit none
c
      character name*6
      integer info, ni, nr, i1, i2
      real r1, r2
c
c  ...1...  function / purpose  .......
c       write error condition / message code information to the 6-th
c       logical unit
c  ...2...  arguments / parameters / constants  .......
c     ..a..  input arguments  .....
c         info  i:1  - error condition / message code number
c         name  a:6  - 6 character name of the subprogram generating
c             the message
c         ni  i:1  - number of integer parameters to be written;
c             = 0, 1, or 2
c         i1,i2  i:1  - integer parameters to be written
c         nr  i:1  - number of real parameters to be written;
c             = 0, 1, or 2
c         r1,r2  r:1  - real parameters to be written
c     ..b..  output arguments  .....
c     ..c..  internal / local variables  .....
c
      character type(5)*9
       integer itype, level
       external ulelvl
c     ..d..  external / subprogram references  .....
c          minerva subroutines - ulelvl
c     ..e..  constants  .....
c
      data type /'nominal', 'survival', 'terminal', 'fatal', 'user'/
c  ...3...  notes / remarks  .......
c     ..a..  usage  .....
c     ..b..  algorithm  .....
c     ..c..  portability  .....
c          ansi 66 - nonstandard hollerith strings
c          ansi 66 - hollerith constant usage
c          ansi 66 - nonstandard data statement
c          ansi 66 - nonstandard character constants
c          ansi 66 - nonstandard quote edit descriptors
c     ..d..  references  .....
c     ..e..  history  .....
c          origin - uertst - imsl, edition 8, june 80
c                 - xerrwv - a.c. hindmarsh, lsode, 3/6/80
c
      if (info .ne. 0) go to 30
c     .........................the above statement was added to
c     .........................stop all screen error messages
c     ......................... makes this a null subroutine
c     ......................... lg price  6/92
      if (info .eq. 0) go to 30
      itype = info / 10
      call ulelvl (level, 0)
      if (itype .lt. level) go to 30
      write (6, 40)
      write (6, 50) type(itype), info, name
      if (ni .le. 0) go to 10
         write (6, 60) 'i1', i1
      if (ni .eq. 1) go to 10
         write (6, 60) 'i2', i2
c
   10 continue
      if (nr .le. 0) go to 20
         write (6, 70) 'r1', r1
      if (nr .eq. 1) go to 20
         write (6, 70) 'r2', r2
c
   20 continue
      write (6, 40)
   30 continue
      return
c
   40 format (1h , 7x, 66('='))
   50 format (1h , 7x, '<<< ', a, 'message: info = ', i2,
     *        ' generated by subprogram ', a, ' >>>')
   60 format (1h , 31x, a, ' = ', i21)
   70 format (1h , 31x, a, ' = ', e21.14)
      end
*endif
